<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>A bokeh server app for up-to-date stock prices &#8211; micbon blog</title> <meta name="description" content="this blog is my personal space for sharing my latest interests."> <meta name="keywords" content="bokeh, bokeh-server, python, data-visualization, heroku, docker"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://blog.micbon.com//assets/img/logo.png"> <meta name="twitter:title" content="A bokeh server app for up-to-date stock prices"> <meta name="twitter:description" content="The python bokeh library lets you build data visualization applications on the web and run them on a server. Below is plot that uses bokeh.server along with other python libraries to display up-to-date (mostly U.S.) stock market closing prices."> <!-- Open Graph --> <meta property="og:locale" content="en_CA"> <meta property="og:type" content="article"> <meta property="og:title" content="A bokeh server app for up-to-date stock prices"> <meta property="og:description" content="The python bokeh library lets you build data visualization applications on the web and run them on a server. Below is plot that uses bokeh.server along with other python libraries to display up-to-date (mostly U.S.) stock market closing prices."> <meta property="og:url" content="https://blog.micbon.com//post/bokeh-server/"> <meta property="og:site_name" content="micbon blog"> <meta property="og:image" content="https://blog.micbon.com//assets/img/logo.png"> <link rel="canonical" href="https://blog.micbon.com//post/bokeh-server/"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" /> <!-- CSS --> <link rel="stylesheet" href="/assets/css/main.css"> <!-- JS --> <script src="/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="shortcut icon" href="/favicon.ico" /> <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png"> <link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"> <link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"> <link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"> <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"> <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"> <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"> <link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"> <link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"> <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"> <!-- Background Image --> <!-- Post Feature Image --> <!-- Use Atom --> <link type="application/atom+xml" rel="alternate" href="https://blog.micbon.com//feed.xml" title="micbon blog" /> <!-- MathJax --> <!-- MathJax --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ extensions: ["tex2jax.js"], jax: ["input/TeX", "output/HTML-CSS"], tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], displayMath: [ ['$$','$$'], ["\\[","\\]"] ], processEscapes: true }, "HTML-CSS": { fonts: ["TeX"] }, TeX: { Macros: { // matched symbols abs: ["\\left\\vert {#1} \\right\\rvert", 1], set: ["\\left\\{ {#1} \\right\\}", 1], brackets: ["\\left[ {#1} \\right]", 1], parens: ["\\left( {#1} \\right)", 1], floor: ["\\left\\lfloor {#1} \\right\\rfloor", 1], ceil: ["\\left\\lceil {#1} \\right\\rceil", 1], norm: ["\\left\\lVert {#1} \\right\\rVert", 1], tuple: ["\\left\\langle {#1} \\right\\rangle", 1], ip: ["\\tuple{#1,#2}", 2], // probability symbols Pr: "\\mathbb{P}", EE: "\\mathbb{E}", Prr: ["\\underset{#1}\\Pr", 1], EEE: ["\\underset{#1}\\EE", 1], var: "\\operatorname{var}", sign: "\\operatorname{sign}", // number sets Nats: "\\mathbb{N}", Ints: "\\mathbb{Z}", Rats: "\\mathbb{Q}", Reals: "\\mathbb{R}", NNInts: "\\Ints_+", NNReals: "\\Reals_+", // UML loss: "\\ell", Domain: "\\mathcal{X}", LabelSet: "\\mathcal{Y}", Dist: "\\mathcal{D}", HS: "\\mathcal{H}", Data: "S", Risk: ["{L_{#1}(#2)}", 2], EmpRisk: ["\\Risk{\\Data\\sim\\Dist^m}{#1}", 1], TrueRisk: ["\\Risk{\\Dist}{#1}", 1], // misc Vector: ["mathbf{#1}", 1], Card: ["\\left\\lvert {#1} \\right\\rvert", 1], defas: "\\overset{\\mathrm{def}}{=}", Indicator: "\\unicode{x1D7D9}", Emptyset: "\\text{\\o}", VCdim: "\\operatorname{VCdim}", Radem: "\\mathfrak{R}", vsig: "\\boldsymbol{\\sigma}", BigO: ["\\mathcal{O}\\left({#1}\\right)", 1], argmax: "\\operatorname{\\arg\\!\\max}", argmin: "\\operatorname{\\arg\\!\\min}" } } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script> --> </script> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="/assets/img/logo.png" alt="micbon blog photo" class="author-photo"> <h4>micbon blog</h4> <p>this blog is my personal space for sharing my latest interests.</p> </li> <li><a href="/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:micbon.site@gmail.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://linkedin.com/in/mjmoon" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://instagram.com/micbonmoon" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-instagram"></i> Instagram</a> </li> <li> <a href="http://github.com/mjmoon" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul><!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="/posts/">All Posts</a></li> <li><a href="/tags/">All Tags</a></li> </ul> </li> <!-- <li> <a href="#">StudyNotes</a> <ul class="dl-submenu"> <li> <a href="https://blog.micbon.com//sta2111">Graduate Probability</a> </li> <li> <a href="https://blog.micbon.com//sta3000">Advanced Theory of Statistics</a> </li> </ul> </li> --> <!-- --> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>A bokeh server app for up-to-date stock prices</h1> <h4>30 Apr 2018</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~2 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn" href="https://blog.micbon.com//posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <p>The python <code class="highlighter-rouge">bokeh</code> library lets you build data visualization applications on the web and run them on a server. Below is plot that uses <a href="https://bokeh.pydata.org/en/latest/docs/user_guide/server.html"><code class="highlighter-rouge">bokeh.server</code></a> along with other python libraries to display up-to-date (mostly U.S.) stock market closing prices.</p> <!-- <link rel="stylesheet" href="/assets/css/slides.css" /> --> <link rel="stylesheet" href="/assets/css/plot/2018-04-30-plot-01.css" /> <!-- <div class="slides-container"> --> <div class="plot-container" style="height:1000px;"> <center> <button class="prev-plot btn disabled" onclick="prevSlide('plot')" disabled="">&#10094;</button> <button class="next-plot btn" onclick="nextSlide('plot')">&#10095;</button> </center> <div> <div class="plot active"> <script src="https://mm-plot-stocks.herokuapp.com/app/autoload.js?bokeh-autoload-element=21904a68-8624-4eea-b517-285e18c24435&amp;bokeh-app-path=/app&amp;bokeh-absolute-url=https://mm-plot-stocks.herokuapp.com/app" id="21904a68-8624-4eea-b517-285e18c24435" data-bokeh-model-id="" data-bokeh-doc-id=""></script> <center><h5>Script embed</h5></center> </div> <div class="plot" style="display:none"> <iframe width="100%" height="820px" id="mm-plot-stocks" src="https://mm-plot-stocks.herokuapp.com/" seamless="seamless" frameborder="0"></iframe> <center><h5>iFrame embed</h5></center> </div> </div> </div> <h2 id="data-sources">Data sources</h2> <p>I used <a href="https://pandas-datareader.readthedocs.io/en/latest/"><code class="highlighter-rouge">pandas-datareader</code></a> and <a href="https://github.com/RomelTorres/alpha_vantage"><code class="highlighter-rouge">alpha_vantage</code></a> python libraries to access free data providers. The former library lets you access stock market data from <em>Morningstar</em> among other providers. <em>Alpha Vantage</em> provides similar data with minimal time delay (1 minute).</p> <h2 id="application">Application</h2> <p>Using <code class="highlighter-rouge">bokeh.server</code>, I was able to plot, add widgets - a button group for period selection and an auto-complete text input box for ticker selection. You can find the source code for the plot here <a href="https://github.com/mjmoon/plot-stocks-bokeh" class="fa fa-github"></a>.</p> <h2 id="deployment">Deployment</h2> <p>I used <a href="https://www.heroku.com"><code class="highlighter-rouge">heroku</code></a>’s free tier service to host the app online. It’s easy to use if you are used to using <code class="highlighter-rouge">git</code>. The free-tier comes with usage limits, most of which are sufficient for my purpose. The only noticeable limit is the fact that the machine goes to sleep after 30 minutes of inactivity. Hence, you likely waited a while until the plot showed up.</p> <p>I also used <a href="https://www.docker.com/"><code class="highlighter-rouge">docker</code></a> to make the app portable to other platforms if necessary (and to get myself familiarized with it).</p> <hr /> <h2 id="notes">Notes</h2> <ul> <li> <p><strong>–allow-websocket-origin</strong></p> <blockquote> <p>By default, cross site connections to the Bokeh server websocket are not allowed. You can enable websocket connections originating from additional hosts by specifying them with the –allow-websocket-origin option.</p> </blockquote> <p>Not really understanding how servers work, I fumbled with this for quite a bit. I added <code class="highlighter-rouge">--allow-websocket-origin=blog.micbon.com</code> as well as <code class="highlighter-rouge">--allow-websocket-origin=mm-plot-stocks.herokuapp.com</code> to allow access from this page and the <code class="highlighter-rouge">heroku</code> page. I embedded the plots using both <code class="highlighter-rouge">&lt;script&gt;</code> and <code class="highlighter-rouge">&lt;iframe&gt;</code> tags to see the difference.</p> </li> <li> <p><strong>not so responsive</strong></p> <p>I found it difficult to make the application responsive (resize along with the display size). It may be possible if I fumbled a little longer but since the plot itself wouldn’t be able to show much when it’s too small I decided to leave it at a fixed size.</p> </li> <li> <p><strong>another plotting library</strong></p> <p>I also created the same plot using <code class="highlighter-rouge">plotly</code>’s <code class="highlighter-rouge">dash</code> module. You can see the app <a href="https://mm-plot-stock-dash.herokuapp.com/" target="_blank">here</a> and the source codes here <a href="https://github.com/mjmoon/plot-stocks" class="fa fa-github" target="_blank"></a>. It was actually easier to use in my opinion. The only trouble I have is making it work with <code class="highlighter-rouge">Docker</code>. I still have not figured out how… :(</p> </li> </ul> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="/tags/#bokeh" title="Pages tagged bokeh" class="tag"><span class="term">bokeh</span></a><a href="/tags/#bokeh-server" title="Pages tagged bokeh-server" class="tag"><span class="term">bokeh-server</span></a><a href="/tags/#python" title="Pages tagged python" class="tag"><span class="term">python</span></a><a href="/tags/#data-visualization" title="Pages tagged data-visualization" class="tag"><span class="term">data-visualization</span></a><a href="/tags/#heroku" title="Pages tagged heroku" class="tag"><span class="term">heroku</span></a><a href="/tags/#docker" title="Pages tagged docker" class="tag"><span class="term">docker</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://blog.micbon.com//post/bokeh-server/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=https://blog.micbon.com//post/bokeh-server/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=https://blog.micbon.com//post/bokeh-server/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> <section> <div class="footer"> &copy; 2019. Michael J. Moon. All rights reserved. <br /> Jekyll Theme: <a href="https://github.com/TaylanTatli/Moon" target="_blank" rel="noopener noreferrer">Moon</a> by TaylanTatli </div> </section> </header> <!-- JS --> <script src="/assets/js/jquery-1.12.0.min.js"></script> <script src="/assets/js/jquery.dlmenu.min.js"></script> <script src="/assets/js/jquery.goup.min.js"></script> <script src="/assets/js/jquery.magnific-popup.min.js"></script> <script src="/assets/js/jquery.fitvid.min.js"></script> <script src="/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'micbon-blog'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <script type="text/javascript"> function prevSlide(item) { var $curr = $('.'+item+ '.active'), ind = $curr.index(); $curr.removeClass('active'); $curr[0].style.display = 'none'; $curr.prev().addClass('active'); $curr.prev()[0].style.display = 'block'; controlSlide(item, ind - 1); }; function nextSlide(item) { var $curr = $('.'+item+ '.active'), ind = $curr.index() + 1; $curr.removeClass('active'); $curr[0].style.display = 'none'; $curr.next().addClass('active'); $curr.next()[0].style.display = 'block'; controlSlide(item, ind + 1); }; function controlSlide(item, ind) { var $items = $('.' + item), $next = $('.next-' + item), $prev = $('.prev-' + item); if (ind == $items.length) { $next.addClass('disabled'); $next.attr({'disabled': true}) } else if ($next.hasClass('disabled')) { $next.removeClass('disabled'); $next.attr({'disabled': false}); } if (ind == 0) { $prev.addClass('disabled'); $prev.attr({'disabled': true}); } else if ($prev.hasClass('disabled')) { $prev.removeClass('disabled'); $prev.attr({'disabled': false}); } }; </script> </body> </html>
